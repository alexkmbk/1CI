 
//
//
Function RunTask(Task, Form, Val Repository = Undefined, Actions = Undefined, TaskDescription = Undefined) Export
		
	RepUserName = Undefined;
	RepPassword = Undefined;
	If Repository = Undefined  Then
		Repository = RepTasks.GetRepository(Task);
	EndIf; 
		
	RepTasks.GetRepPasswordAndUserName(Repository, RepUserName, RepPassword);	
	If ValueIsFilled(RepUserName) Then
		RepTasks.RunTask(Task, True, Repository, RepUserName, RepPassword, Actions, TaskDescription);
	Else
		Params = New Structure("Repository, Task", Repository, Task);
		OpenForm("CommonForm.RepositoryUserNameAndPasswordInput", Params);
	EndIf; 
	
EndFunction

//
//
Function GetSystemEmailAccount() Export
		Return RepTasks.GetSystemEmailAccount();
EndFunction
 
